<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Bootstrap demo</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-9ndCyUaIbzAi2FUVXJi0CjmCapSmO7SnpJef0486qhLnuZ2cdeRhO02iuK6FUUVM" crossorigin="anonymous">
  <style>
    html,
    body {
      font-family: monospace;
    }

    #div-bear-type {
      font-family: sans-serif;
      font-size: 1.1em;
      line-height: 30px;
    }

    #div-image-output {
      background-color: #ccc;
      border-style: solid;
      padding: 2px;
      border-color: #777;
      border-width: 2px;
      max-width: 800px;
      text-align: center;
    }

    #img-output {
      max-width: 800px;
    }

    input#image-url {
      width: 500px;
      padding: 1px 2px;
    }
  </style>

  <script>

    document.addEventListener('DOMContentLoaded', () => {

      const btn = document.getElementById('button-submit');
      const inputImageUrl = document.getElementById('image-url');
      const imgOutput = document.getElementById('img-output');
      const bearTypeOutput = document.getElementById('div-bear-type');

      btn.addEventListener('click', () => submit(inputImageUrl.value));

      function submit(value) {
        const http = new XMLHttpRequest()
        http.open('POST', 'https://thiagoh-test.hf.space/display-image')
        http.setRequestHeader('Content-type', 'application/json');
        http.onreadystatechange = function () {//Call a function when the state changes.
          if (http.readyState === XMLHttpRequest.DONE && http.status == 200) {
            console.log(http);
            const data = JSON.parse(http.responseText)
            // imgOutput.src = 'data:image/png;base64,' + data.imageEncodedBytes;
            imgOutput.src = value;
            bearTypeOutput.innerHTML = `Type is ${data.prediction} with confidence ${data.probability}`;
          }
        }
        http.send(JSON.stringify({ imageUrl: value }));
      }
    });

  </script>
</head>

<body>

  <div id="div-input-fields">
    Url:
    <input type="url" id="image-url" placeholder="https://example.com/my-image.jpg" />
  </div>

  <div>
    <input type="button" id="button-submit" value="Submit" />
  </div>

  <div>
    <div id="div-bear-type"></div>
    <div id="div-image-output">
      <img id="img-output" />
    </div>
  </div>
</body>

</html>
