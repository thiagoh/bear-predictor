<html>

<style>
  html, body {
    font-family: monospace;
  }
  input#image-url {
    width: 500px;
    padding: 1px 2px;
  }
</style>

<script>

  document.addEventListener('DOMContentLoaded', () => {

    const btn = document.getElementById('button-submit');
    const inputImageUrl = document.getElementById('image-url');
    const imgOutput = document.getElementById('img-output');
    const bearTypeOutput = document.getElementById('span-bear-type');

    btn.addEventListener('click', () => submit(inputImageUrl.value));

    function submit(value) {
      const http = new XMLHttpRequest()
      http.open('POST', 'https://thiagoh-test.hf.space/display-image')
      http.setRequestHeader('Content-type', 'application/json');
      http.onreadystatechange = function () {//Call a function when the state changes.
        if (http.readyState == 4 && http.status == 200) {
          console.log(http);
          const data = JSON.parse(http.responseText)
          imgOutput.src = 'data:image/png;base64,' + data.imageEncodedBytes;
          bearTypeOutput.innerHTML = `Type is ${data.prediction} with confidence ${data.probability}`;
        }
      }
      http.send(JSON.stringify({ imageUrl: value }));
    }
  });

</script>

<body>

  <div>
    <input type="url" id="image-url" placeholder="https://example.com/my-image.jpg" />
    <input type="button" id="button-submit" value="Submit" />
  </div>

  <div>
    <span id="span-bear-type"></span>
    <img id="img-output" />
  </div>
</body>

</html>
